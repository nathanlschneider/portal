<!DOCTYPE html>
<html lang="en">
<head>
  <title>IT HelpDesk Portal</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <link rel="stylesheet" href="css/style.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
</head>
<body>



      <script src = 'http://mhg-heat-web/HEAT/Modules/HEATAPI/HEATApiClient?clientId=PORTAL&clientKey==8FRPgaPuPhuGwxK9mwfVX4PHVP0t24PwpgxL3ou3lw='> </script> 
     
     
      <script> 
        function logout() {
        HEATAPI.Auth.signOut(function (data) {
 
          if (window.confirm('Do you really want to log out?'))
{
    location.reload();
}
else
{
    // They clicked no
} 
        
        })}
     </script>


 
      <!-- Navigation -->
      <nav class="navbar navbar-inverse navbar-fixed-top">
         <div class="container">
            <!-- Logo and responsive toggle -->
            <div class="navbar-header">
               <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
               <span class="sr-only">Toggle navigation</span>
               <span class="icon-bar"></span>
               <span class="icon-bar"></span>
               <span class="icon-bar"></span>
               </button>
               <a class="navbar-brand" href="#">IT HelpDesk Portal</a>
            </div>
            <!-- Navbar links -->
            <div class="collapse navbar-collapse" id="navbar">
               <ul class="nav navbar-nav">
                  <li class="active">
                     <a href="#">Tickets</a>
                  </li>
                  <li>
                     <a href="#">Contact</a>
                  </li>
                  <li>
                     <a href="#">Knowledge Base</a>
                  </li>
                  <li>
                     <a href="#">Links</a>
                  </li>
                  <li>
                     <a id="alertLink" onclick="invis()" href="alerts.html" target="_blank"> Alerts <span id="alterNotice" class="label label-danger">new</span></a>
                  </li>
               </ul>
               <!-- Log In Form -->
               <form class="navbar-form navbar-right">
                  <div id="userInfo" class="form-group">
                   
                   <script>

</script>
                     <script>
                        HEATAPI.Auth.getSignInfo(function(data) {
                          if (data.login !== "") {
                          document.getElementById('userInfo').innerHTML =
                          "Hello, " + data.login + "! ";
                           var div = document.getElementById('mainBody');
                           div.style.display = "block";
                        } else {
                         var div = document.getElementById('mainBody');
                        div.style.display = "none";
                        };
                        }
                        )
                     </script>
                  </div>
                 
                  <button id="logoutButton" type="button" class="btn btn-default" onclick="logout()"> Logout</button>
                <!-- <button type="button" onclick="testit()"> Test</button> -->
                 <button type="button" class="btn btn-default" data-toggle="collapse" data-target="#alerter">Test</button>
                 
                 <script>
                 function invis() {
                 var div = document.getElementById('alterNotice');
                 div.style.display = 'none';}

               </script>
               </form>
            </div>
            <!-- /.navbar-collapse -->
         </div>
         <!-- /.container -->
      </nav>
    
    <div class="header-blurb">
</div>

    
    <div id="alerter" class="alert alert-danger alert-dismissable collapse">
      <a href="#" class="close" data-dismiss="alert" aria-label="close">Ã—</a>
    <span class="glyphicon glyphicon-alert" style="padding:5px"></span><strong>Alert!</strong> There is something wrong. Please <a href="#" class="alert-link">contact </a>the HelpDesk.
    
    </div>
  
<div id ="mainBody" class="container-fluid">
  <div class="row">
  <div class="col-md-6" id="left"><h2>Ticket History</h2>
  <iframe name="leftIframe" src="" width="100%" height="400px" frameBorder="0"></iframe>
  </div>
  <div class="col-md-6" id="right"><h2>Submit a Ticket</h2></div>
</div>
  <script>
    var guts = '<h2>Submit a Ticket</h2><div class="form-group"><label for="issue">Issue:</label><input type="text" class="form-control" id="detail"><label for="desc">Description:</label><textarea class="form-control" rows="2" id="description"></textarea><br><button type="submit" class="btn btn-default" onclick="subtick()">Submit</button></div>';
      document.getElementById('right').innerHTML = guts;
  </script>

<script>
function subtick() { 

    HEATAPI.Auth.CreateIncident("test","test")

                   }
</script>

<script>
  function testit() {

};
</script>





 <script> HEATAPI.MyItems.GetMyItemsList(10, function(data) {
   var summary = [];
   var cstatus = [];
   var cdate = [];
   var inc = 0;
   var statusColored = "";
   for (var i in data.data) {
      var astatus = data.data[i].status;
      if (data.data[i].status == "Logged") {
         statusColored = astatus.fontcolor("orange");
      }
      if (data.data[i].status == "Active") {
         statusColored = astatus.fontcolor("red");
      }

       if (data.data[i].status == "Closed") {
         statusColored = astatus.fontcolor("purple");
      }

      if (data.data[i].status == "Resolved") {
         statusColored = astatus.fontcolor("green");
      }
      linkMod = data.data[i].link.replace("false", "true")
      summary[i] = "<a href='" + linkMod + "' target='leftIframe'><span id='tableLink'>" + data.data[i].summary + " </span></a>";
      cstatus[i] = statusColored;
      cdate[i] = data.data[i].createdOn;
   };
   var table = document.createElement('table'),
      th, tr, td, row, cell, heada;
   for (row = -1; row < i; row++) {
      tr = document.createElement('tr');
      for (cell = 0; cell < 1; cell++) {
         td = document.createElement('td');
         tr.appendChild(td);
         td.innerHTML = summary[inc];
      }
      for (cell = 0; cell < 1; cell++) {
         td = document.createElement('td');
         tr.appendChild(td);
         td.innerHTML = cstatus[inc];
      }
      for (cell = 0; cell < 1; cell++) {
         td = document.createElement('td');
         tr.appendChild(td);
         td.innerHTML = cdate[inc];
      }
      inc++;
      table.appendChild(tr);
   }
   document.getElementById('left').appendChild(table);
}); 
          </script>
</div>
     
     
   <!-- <div class="footer-blurb"></div> -->

<iframe name="tail" src="" width="100%" height="550px" frameBorder="0"></iframe>
  
        <div class="footCont">
            <br><p><a href="#">Website Issues</a> | <a href="#">More Stuff</a> | <a href="#">Contact</a> - Copyright &copy; Meritage Hospitality Group, Inc. 2017 </p>
        </div>
   </body>
</html>